package day04

case class Elf(sectionIds: List[Int])

object day04 extends App {

  val input = "71-71,42-72\n27-28,27-99\n15-79,14-78\n3-36,4-36\n5-67,32-57\n7-85,5-86\n2-97,97-97\n10-73,41-55\n34-99,34-55\n80-80,25-80\n50-76,50-79\n42-70,43-70\n95-96,81-96\n6-7,6-94\n37-39,17-38\n39-95,26-96\n52-77,53-76\n2-99,9-95\n23-94,79-91\n19-78,44-77\n47-47,1-48\n4-88,3-52\n51-60,50-52\n49-90,21-89\n76-95,97-99\n78-96,79-95\n90-90,77-90\n8-73,9-72\n54-54,54-74\n20-40,19-40\n7-96,7-7\n16-73,54-77\n8-30,33-59\n71-99,71-72\n22-74,21-74\n58-94,93-95\n92-96,34-94\n5-60,6-61\n2-78,41-79\n63-63,54-64\n21-55,78-88\n1-97,6-95\n14-52,14-73\n5-30,6-30\n4-82,3-91\n9-98,8-97\n1-99,9-95\n35-46,34-79\n2-3,2-45\n2-78,2-78\n11-57,56-57\n78-79,54-78\n17-81,18-43\n76-79,77-88\n4-90,11-91\n1-94,94-95\n57-93,56-92\n13-13,14-99\n42-50,10-50\n34-86,33-85\n2-25,1-95\n6-95,3-95\n5-31,8-30\n3-13,4-19\n10-97,9-60\n13-94,12-14\n9-93,8-93\n18-96,18-97\n53-94,53-74\n33-33,11-74\n58-76,76-77\n7-66,8-82\n38-76,37-77\n1-2,1-96\n24-98,23-99\n2-67,2-66\n30-84,1-30\n8-99,7-99\n89-94,78-89\n11-13,12-66\n75-83,12-75\n2-34,1-92\n36-38,36-93\n4-94,2-93\n6-95,6-99\n19-52,20-52\n49-95,48-94\n5-45,45-46\n3-96,4-84\n21-37,30-83\n33-67,67-67\n30-87,86-87\n73-73,7-73\n4-89,1-88\n5-60,60-61\n51-69,52-68\n3-92,2-3\n3-95,2-95\n13-73,70-71\n7-83,8-60\n62-94,94-94\n23-36,32-39\n17-52,45-53\n53-72,67-68\n48-95,49-49\n14-17,11-16\n70-97,70-96\n13-14,13-30\n9-9,8-97\n2-12,3-43\n79-79,37-79\n3-97,1-96\n56-77,55-77\n34-34,33-91\n2-80,81-81\n17-94,49-95\n25-84,13-85\n23-88,24-24\n1-35,2-23\n30-92,29-92\n37-37,37-38\n63-80,78-80\n4-83,1-83\n9-97,8-79\n2-98,3-88\n17-87,17-89\n37-38,38-60\n79-84,77-89\n5-96,96-97\n3-57,4-56\n50-91,46-50\n7-21,7-76\n79-96,25-79\n1-65,55-65\n16-93,15-97\n12-13,15-99\n68-97,18-61\n7-91,7-91\n16-89,15-90\n8-8,8-99\n28-28,10-29\n17-82,83-83\n17-74,19-73\n17-88,87-89\n11-31,10-32\n85-89,47-76\n34-61,34-35\n82-99,92-99\n14-41,13-42\n46-97,97-99\n3-51,4-51\n40-88,41-68\n58-64,55-63\n87-90,14-87\n7-39,8-9\n15-67,14-68\n21-95,20-92\n27-99,28-60\n50-87,50-88\n39-95,38-39\n67-67,66-67\n30-75,30-75\n54-89,53-90\n10-46,2-45\n30-90,12-94\n29-58,30-57\n22-22,21-73\n31-57,11-54\n10-65,10-89\n17-45,29-35\n43-58,44-73\n8-94,8-93\n26-43,8-26\n22-37,37-37\n26-57,13-56\n47-86,86-87\n89-89,58-89\n5-76,4-5\n96-96,30-97\n8-44,43-44\n22-78,22-77\n35-69,35-70\n7-93,6-59\n3-3,3-99\n23-99,23-98\n75-89,90-90\n13-97,97-97\n93-97,22-94\n36-46,45-46\n16-28,17-28\n26-78,78-91\n6-99,5-6\n55-94,40-94\n2-80,3-71\n13-13,12-94\n77-79,6-78\n1-80,5-74\n54-95,67-96\n23-89,80-89\n6-36,2-50\n2-3,3-65\n39-98,27-98\n59-66,35-78\n9-83,1-8\n41-66,58-67\n4-67,4-68\n9-77,77-78\n65-85,32-99\n43-94,31-44\n1-33,1-33\n5-50,5-19\n39-71,14-70\n1-99,53-99\n6-71,5-70\n17-88,18-88\n41-63,13-63\n4-4,3-89\n3-95,2-2\n15-21,6-21\n22-99,27-96\n1-87,56-71\n73-73,74-89\n65-95,66-94\n5-69,25-69\n21-86,21-55\n14-88,15-87\n20-33,19-34\n14-50,63-85\n7-23,22-55\n56-90,55-89\n60-85,60-61\n82-85,79-84\n66-66,99-99\n1-1,2-63\n6-61,1-6\n26-97,26-26\n36-81,76-82\n49-78,49-79\n17-99,12-98\n1-92,91-91\n11-97,99-99\n33-96,42-44\n8-71,3-76\n67-71,67-68\n49-72,49-71\n28-28,13-29\n38-68,67-67\n15-48,14-88\n16-37,16-36\n76-84,76-76\n5-96,26-97\n35-36,4-35\n1-96,2-97\n71-71,3-70\n37-87,37-86\n29-52,52-53\n12-79,16-80\n46-88,8-87\n8-91,8-84\n21-96,21-95\n17-97,7-96\n51-77,36-77\n13-21,6-13\n64-77,63-64\n4-8,2-44\n63-80,64-66\n51-90,52-89\n34-34,34-73\n3-81,1-81\n19-19,19-53\n68-73,14-51\n4-58,59-59\n8-30,12-30\n4-82,5-81\n26-99,27-99\n27-89,26-88\n38-62,55-85\n6-95,7-94\n18-56,17-55\n44-81,44-74\n16-20,14-19\n37-68,14-78\n6-11,7-10\n24-86,25-99\n10-97,1-97\n52-80,53-81\n28-64,28-63\n67-69,68-69\n3-5,3-5\n12-64,64-64\n3-4,4-71\n34-34,5-34\n29-36,28-74\n3-60,2-97\n36-93,35-92\n51-81,52-80\n13-80,10-96\n17-97,96-98\n90-92,19-91\n76-77,77-98\n42-42,48-73\n88-97,16-85\n70-75,37-74\n55-89,55-65\n38-73,41-72\n74-75,27-74\n32-43,41-43\n39-98,21-97\n43-71,42-43\n93-93,72-94\n19-45,19-44\n45-46,46-70\n2-70,2-69\n16-97,15-97\n26-63,25-62\n19-21,19-20\n7-98,10-98\n21-22,22-88\n51-93,49-92\n14-87,86-86\n37-50,36-72\n14-71,14-91\n27-29,28-73\n98-98,44-97\n20-41,19-24\n42-81,81-81\n54-55,10-55\n56-66,67-67\n46-77,46-78\n6-7,7-72\n74-95,69-76\n10-88,2-87\n45-84,44-84\n43-89,18-93\n19-77,19-76\n12-93,11-93\n60-61,18-60\n1-29,4-29\n39-52,25-51\n5-86,5-88\n3-95,5-90\n78-80,9-79\n29-56,29-55\n24-96,23-96\n19-93,92-94\n91-91,8-92\n53-58,22-67\n46-48,25-49\n22-28,29-29\n7-87,7-90\n14-94,13-14\n2-98,3-99\n14-80,13-81\n6-99,7-35\n3-86,2-87\n41-98,42-88\n15-15,11-15\n32-75,31-32\n11-45,16-26\n4-79,80-98\n90-92,91-93\n2-2,1-98\n24-65,23-23\n7-69,7-70\n76-84,77-83\n38-63,63-79\n11-11,10-46\n10-89,10-99\n16-73,16-72\n22-77,17-78\n99-99,25-99\n6-96,95-96\n52-90,52-62\n76-76,76-77\n14-88,14-88\n26-81,25-96\n53-81,81-81\n38-97,37-73\n16-81,15-15\n30-58,30-58\n61-89,5-89\n14-60,13-15\n22-93,23-94\n19-43,18-31\n6-87,1-87\n1-99,2-98\n3-84,75-84\n70-76,71-72\n15-15,15-39\n6-92,5-93\n3-32,2-31\n30-83,56-83\n78-78,79-98\n7-98,6-42\n18-57,18-57\n8-76,3-91\n12-97,13-98\n36-51,37-83\n3-95,1-97\n25-67,25-25\n14-79,14-33\n91-92,91-91\n3-80,2-81\n38-92,91-92\n93-98,93-97\n21-22,22-36\n31-89,27-30\n14-95,13-13\n25-36,24-36\n43-71,30-79\n37-37,36-83\n2-94,3-98\n2-89,60-88\n7-98,6-8\n66-70,65-70\n11-71,97-99\n9-95,8-94\n4-77,5-76\n38-85,37-86\n18-51,17-19\n13-13,6-13\n71-81,70-80\n46-81,47-47\n69-69,68-76\n37-56,37-56\n96-97,6-96\n53-59,54-58\n45-50,2-49\n5-33,6-6\n16-61,16-61\n13-51,3-51\n5-82,4-53\n5-81,54-81\n2-18,18-19\n29-29,5-29\n12-81,13-81\n2-71,16-71\n48-92,32-42\n8-12,8-75\n47-86,86-86\n5-97,4-96\n75-75,16-74\n13-95,8-97\n10-90,9-91\n48-62,47-63\n3-18,2-2\n1-18,17-81\n45-83,25-84\n36-91,37-92\n85-99,15-85\n39-85,2-96\n24-96,11-94\n12-89,11-58\n47-72,59-73\n31-91,30-81\n33-43,34-41\n16-83,15-83\n22-55,21-54\n39-82,26-97\n10-95,11-96\n2-98,4-79\n17-37,16-41\n76-76,25-77\n65-73,74-77\n9-82,82-83\n30-57,31-76\n4-74,5-34\n31-87,86-87\n65-74,15-73\n36-36,35-36\n1-99,1-2\n31-79,78-79\n6-88,7-96\n73-86,74-93\n31-49,49-85\n2-98,1-3\n14-57,15-58\n83-96,96-97\n6-92,6-93\n6-95,3-94\n16-96,26-92\n6-85,2-85\n38-39,38-92\n96-97,33-93\n12-13,13-51\n5-5,4-4\n1-95,1-95\n69-71,69-73\n27-98,26-99\n5-25,4-26\n43-68,68-69\n8-56,15-56\n3-99,4-98\n5-5,5-96\n17-71,18-32\n53-53,53-99\n12-18,14-19\n20-94,20-93\n15-62,14-63\n59-59,59-73\n99-99,11-96\n47-98,46-47\n4-86,86-86\n1-1,3-64\n19-45,18-84\n1-86,9-87\n45-45,32-46\n41-63,63-64\n3-5,5-38\n34-70,33-70\n34-91,3-92\n12-45,11-45\n29-30,34-86\n24-55,55-56\n6-41,7-99\n87-88,5-87\n5-63,6-6\n63-63,63-68\n2-95,96-98\n17-25,33-98\n40-99,41-82\n21-41,42-46\n50-86,12-91\n11-64,10-63\n21-21,21-39\n10-96,10-95\n18-95,18-94\n73-79,80-93\n14-69,15-70\n25-83,26-26\n83-94,61-82\n16-90,64-96\n2-3,3-21\n7-45,7-57\n6-85,5-84\n22-94,21-21\n5-64,5-63\n96-99,70-96\n18-87,17-18\n6-99,6-11\n49-49,2-48\n7-64,65-69\n41-46,14-47\n92-92,8-92\n6-96,5-24\n57-85,57-84\n39-99,40-99\n80-86,86-86\n52-91,94-98\n67-88,15-66\n15-39,40-40\n22-92,23-23\n31-84,74-84\n43-43,25-43\n16-90,15-85\n5-36,7-36\n53-58,52-59\n14-96,99-99\n3-94,2-95\n97-99,49-97\n7-67,54-67\n12-72,72-73\n69-76,75-75\n59-79,60-64\n72-99,78-92\n80-80,80-86\n25-26,25-88\n27-43,27-44\n27-76,18-75\n22-23,5-23\n52-69,53-70\n16-64,16-98\n3-51,5-96\n3-72,2-20\n26-26,27-37\n58-91,90-91\n14-20,11-44\n5-99,5-6\n31-32,31-99\n9-93,93-93\n21-81,20-80\n47-99,49-50\n28-89,27-28\n30-77,30-30\n91-93,59-92\n4-78,40-89\n38-95,39-78\n27-58,26-58\n32-92,24-32\n69-91,35-69\n31-95,13-94\n8-8,7-99\n14-93,8-93\n36-78,16-79\n7-53,10-52\n98-99,5-98\n9-15,10-14\n1-98,2-98\n2-60,3-60\n33-70,32-32\n83-97,82-89\n92-92,32-91\n1-97,1-96\n85-95,48-77\n3-26,4-4\n14-14,13-88\n13-90,14-91\n28-67,27-66\n69-75,76-76\n31-97,16-96\n21-47,46-47\n50-51,40-51\n17-97,8-97\n3-98,4-97\n58-97,59-92\n8-15,7-15\n94-95,4-94\n45-56,44-50\n21-44,22-43\n16-72,15-71\n65-84,65-84\n18-46,63-72\n61-71,41-54\n10-36,9-66\n3-68,3-69\n19-19,18-20\n69-70,4-69\n72-72,71-73\n30-95,30-31\n76-77,76-86\n21-71,21-66\n36-36,37-47\n17-98,98-98\n38-74,39-39\n1-95,3-94\n9-17,11-18\n1-93,1-94\n49-75,67-76\n83-91,90-91\n8-71,37-62\n31-51,22-50\n45-99,46-98\n8-32,6-32\n50-50,50-78\n75-80,75-81\n1-68,14-83\n13-90,6-95\n3-47,3-85\n25-47,25-25\n15-77,5-57\n7-69,48-69\n21-74,22-73\n48-84,83-84\n14-14,13-65\n41-96,20-98\n73-93,24-92\n14-45,15-15\n98-98,6-99\n34-63,33-34\n10-93,92-94\n2-97,31-97\n30-99,30-86\n6-89,89-90\n65-94,42-64\n38-40,39-74\n1-1,1-40\n9-26,25-25\n2-95,95-96\n14-93,10-92\n84-86,4-84\n21-21,20-92\n56-98,31-97\n4-31,3-31\n2-20,21-21\n12-91,13-91\n1-90,2-79\n3-4,4-80\n12-89,13-88\n6-88,88-88\n22-90,22-22\n18-87,19-35\n28-71,29-49\n39-52,52-53\n73-82,72-74\n70-98,30-99\n31-40,37-40\n10-28,15-86\n48-92,65-91\n10-96,9-11\n22-98,21-23\n2-98,3-21\n34-34,33-72\n23-42,2-58\n26-98,49-97\n65-95,29-94\n48-48,47-49\n23-66,22-65\n97-98,83-98\n32-47,31-53\n24-26,15-25\n82-88,89-89\n85-96,85-98\n22-76,24-77\n84-85,84-86\n26-27,26-98\n10-88,14-71\n73-81,1-72\n79-88,15-88\n74-86,64-87\n27-56,28-55\n37-38,36-89\n1-47,17-48\n50-94,45-76\n35-90,34-90\n7-98,6-6\n2-95,5-96\n60-95,60-98\n94-96,5-93\n25-97,28-98\n9-9,9-98\n6-15,15-83\n11-32,12-75\n7-97,7-99\n17-17,17-58\n46-95,45-94\n10-86,11-11\n41-43,40-43\n7-74,34-75\n8-97,9-97\n72-82,82-98\n19-20,19-38\n7-94,6-95\n9-48,10-97\n47-73,48-48\n32-93,8-99\n12-65,11-13\n43-51,27-50\n35-67,34-66\n9-28,9-28\n25-86,18-85\n92-92,11-93\n66-66,36-66\n59-60,12-59\n5-21,4-4\n40-93,40-93\n56-86,57-87\n2-97,1-2\n61-94,60-93\n36-64,35-65\n62-94,62-95\n27-99,27-27\n36-52,35-36\n31-91,30-31\n35-93,92-94\n2-98,1-3\n74-74,6-74\n46-79,80-80\n19-95,17-94\n15-16,16-83\n1-94,3-93\n79-79,10-79\n10-75,9-74\n2-84,1-83\n19-83,19-82\n13-14,14-34\n33-57,33-58\n3-7,4-91\n25-25,24-48\n46-47,44-46\n85-86,19-85\n40-42,37-42\n72-88,64-84\n25-68,25-25\n88-88,89-89\n3-14,4-15\n12-98,12-92\n5-90,38-91\n41-58,42-59\n24-63,64-84\n47-48,29-47\n30-62,62-77\n43-80,44-97\n90-99,5-90\n12-58,58-58\n18-66,6-87\n30-89,65-83\n23-93,93-93\n7-19,6-18\n12-99,13-57\n5-27,27-30\n3-4,4-75\n14-26,14-23\n91-95,34-94\n52-83,53-53\n16-24,13-23\n56-70,70-71\n10-80,80-81\n58-97,91-99\n16-82,46-83\n15-16,15-83\n26-81,27-80\n65-65,46-65\n23-93,24-92\n42-92,6-91\n25-65,25-25\n9-72,8-77\n36-94,35-37\n44-86,43-45\n51-89,50-90\n69-71,68-77\n10-36,28-37\n22-75,74-74\n38-38,37-94\n42-70,41-70\n3-92,2-72\n18-89,89-95\n82-89,6-89\n75-76,11-75\n12-26,19-27\n21-83,21-84\n2-97,3-99\n13-97,13-97\n89-92,89-89\n29-73,2-5\n41-60,50-59\n12-68,11-67\n26-59,26-58\n22-64,22-72\n31-74,30-75\n41-49,41-49\n26-92,19-92\n53-65,52-52\n47-54,53-55\n81-99,80-81\n22-81,23-81\n15-40,14-40\n5-96,4-96\n21-98,2-97\n13-57,6-56\n13-47,12-31\n66-66,58-65\n2-39,10-39\n11-82,10-81\n94-96,11-66\n5-61,4-60\n35-88,89-98\n58-80,58-81\n15-98,14-16\n33-99,32-34\n4-97,77-98\n14-15,40-47\n31-51,30-52\n28-97,29-97\n79-84,79-85\n19-64,19-63\n3-3,3-75\n36-72,37-92\n6-26,4-75\n4-4,3-13\n44-44,44-69\n3-93,4-93\n47-96,47-96\n15-54,16-41\n78-98,77-97\n53-55,32-55\n88-89,76-88\n16-84,15-95\n82-82,3-83\n43-44,28-43\n66-66,65-81\n6-96,5-95\n83-90,30-84\n61-72,39-61\n2-51,1-52\n11-18,10-24\n65-66,63-65\n7-97,1-96\n6-33,6-6\n50-89,51-51\n22-53,14-52\n49-97,48-98\n5-98,6-44\n15-85,14-84\n29-95,30-96\n75-76,42-75\n37-53,37-52\n3-84,3-3\n33-97,33-69\n49-98,63-99\n77-84,75-83\n3-77,1-76\n60-94,59-85\n79-80,3-79\n32-35,32-36\n30-31,31-89\n15-16,16-86\n8-98,8-97\n42-87,43-88\n34-64,20-63\n7-97,46-98\n4-19,19-67\n39-90,41-90\n40-78,78-79\n50-73,14-92\n58-87,59-60\n4-82,3-4\n61-63,60-68\n1-6,6-61\n17-19,17-18\n5-62,10-36\n15-40,14-39\n59-70,60-69\n93-95,37-92\n14-97,7-99\n91-92,55-91\n38-88,26-42\n6-72,5-7\n77-96,77-97\n5-84,84-84\n29-47,22-32\n53-54,52-53\n11-95,95-96\n7-40,21-95\n99-99,47-99\n18-76,18-82\n1-93,26-93\n37-37,2-41\n71-71,4-71\n26-97,26-26\n68-69,3-68\n96-96,24-97\n41-80,40-65\n54-99,67-95\n80-90,81-93\n35-59,35-59\n16-44,16-44\n2-78,19-79\n16-16,16-97\n2-38,2-2\n8-16,2-16\n47-72,48-73\n15-28,14-29\n4-90,5-5\n46-99,19-95\n66-86,66-77\n61-97,61-96\n30-93,47-93\n59-81,60-80\n21-22,21-22\n36-78,35-77\n35-93,35-35\n34-34,33-49\n24-69,1-68\n9-84,15-84\n11-11,10-94\n3-59,3-4\n25-69,68-68\n93-94,3-93\n72-98,85-98\n36-95,36-94\n36-85,36-86\n9-39,9-40\n97-98,34-97\n24-84,77-85\n37-85,38-38\n92-93,34-91\n44-69,43-78\n2-83,82-84\n19-37,40-62\n56-79,54-78\n60-60,60-97\n46-66,46-67\n18-76,19-86\n40-67,20-67\n13-98,14-97\n63-65,62-64\n22-88,21-89\n45-77,46-78\n14-52,14-53\n38-59,38-60\n1-21,21-21\n62-70,61-62\n50-56,23-99\n4-96,53-97\n68-69,19-68\n35-76,34-76\n29-76,30-77\n12-91,13-90\n7-94,96-99\n5-85,5-81\n56-57,57-58\n26-26,27-98\n12-28,11-58\n11-32,10-32\n10-42,10-56\n46-63,38-62\n31-95,3-94\n76-82,41-75\n87-88,4-88\n21-33,20-32"

  def rangeToList(range: String): List[Int] = {
    val from = range.split("-")(0).toInt
    val to = range.split("-")(1).toInt
    Range.inclusive(from, to).toList
  }

  val formattedInput: List[(Elf, Elf)] = input
    .split("\n")
    .map(x => x.split(","))
    .map(pair => (rangeToList(pair(0)), rangeToList(pair(1))))
    .map(pair => (Elf(pair._1), Elf(pair._2)))
    .toList

  def findOverlappingSections(elf1: Elf, elf2: Elf): Set[Int] = {
    val allSections: Set[Int] = Set.empty ++ elf1.sectionIds ++ elf2.sectionIds
    for {
      section <- allSections
      if elf1.sectionIds.contains(section) && elf2.sectionIds.contains(section)
    } yield section
  }

  def isFullyOverlapping(elf1: Elf, elf2: Elf): Boolean = {
    val overlappingSections: Set[Int] = findOverlappingSections(elf1, elf2)
    if (elf1.sectionIds.toSet.equals(overlappingSections) ||
        elf2.sectionIds.toSet.equals(overlappingSections)) true
    else false
  }

  val fullyOverlappingCount = formattedInput.map(x => isFullyOverlapping(x._1, x._2)).count(_ == true)
  println(fullyOverlappingCount)
}
